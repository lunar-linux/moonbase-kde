From ee17e7659a97b36b58cab28b2b56cede7cd153c6 Mon Sep 17 00:00:00 2001
From: Stefan Gerlach <stefan.gerlach@uni-konstanz.de>
Date: Fri, 31 Oct 2025 12:10:29 +0100
Subject: [PATCH] cmake: support orcus 0.21

---
 cmake/FindOrcus.cmake                             | 10 +++++-----
 src/backend/spreadsheet/StatisticsSpreadsheet.cpp | 10 ++++------
 2 files changed, 9 insertions(+), 11 deletions(-)

diff --git a/cmake/FindOrcus.cmake b/cmake/FindOrcus.cmake
index 004f5624b7..959358ebc3 100644
--- a/cmake/FindOrcus.cmake
+++ b/cmake/FindOrcus.cmake
@@ -14,21 +14,21 @@ if (Orcus_INCLUDE_DIR AND Orcus_LIBRARIES)
     set (Orcus_FOUND TRUE)
 else ()
     find_package(PkgConfig QUIET)
-    pkg_search_module(PC_ORCUS liborcus liborcus-0.20 liborcus-0.19 liborcus-0.18 liborcus-0.17 liborcus-0.16 QUIET)
+    pkg_search_module(PC_ORCUS liborcus liborcus-0.21 liborcus-0.20 liborcus-0.19 liborcus-0.18 liborcus-0.17 liborcus-0.16 QUIET)
     pkg_search_module(PC_IXION libixion libixion-0.20 libixion-0.19 libixion-0.18 libixion-0.17 libixion-0.16 QUIET)
 
     find_library (Orcus_LIBRARY
-        NAMES orcus orcus-0.20 orcus-0.19 orcus-0.18 orcus-0.17 orcus-0.16
+        NAMES orcus orcus-0.21 orcus-0.20 orcus-0.19 orcus-0.18 orcus-0.17 orcus-0.16
         HINTS ${PC_ORCUS_LIBRARY_DIRS}
         PATH_SUFFIXES orcus
     )
     find_library (Orcus_parser_LIBRARY
-        NAMES orcus-parser orcus-parser-0.20 orcus-parser-0.19 orcus-parser-0.18 orcus-parser-0.17 orcus-parser-0.16
+        NAMES orcus-parser orcus-parser-0.21 orcus-parser-0.20 orcus-parser-0.19 orcus-parser-0.18 orcus-parser-0.17 orcus-parser-0.16
         HINTS ${PC_ORCUS_LIBRARY_DIRS}
         PATH_SUFFIXES orcus
     )
     find_library (Orcus_spreadsheet_LIBRARY
-        NAMES orcus-spreadsheet-model orcus-spreadsheet-model-0.20 orcus-spreadsheet-model-0.19 orcus-spreadsheet-model-0.18 orcus-spreadsheet-model-0.17 orcus-spreadsheet-model-0.16
+        NAMES orcus-spreadsheet-model orcus-spreadsheet-model-0.21 orcus-spreadsheet-model-0.20 orcus-spreadsheet-model-0.19 orcus-spreadsheet-model-0.18 orcus-spreadsheet-model-0.17 orcus-spreadsheet-model-0.16
         HINTS ${PC_ORCUS_LIBRARY_DIRS}
         PATH_SUFFIXES orcus
     )
@@ -69,7 +69,7 @@ else ()
     set(LIBIXION_VERSION ${PC_IXION_VERSION})
     # latest version
     if (NOT DEFINED LIBORCUS_VERSION)
-        set(LIBORCUS_VERSION "0.20.0")
+        set(LIBORCUS_VERSION "0.21.0")
     endif()
     if (NOT DEFINED LIBIXION_VERSION)
             set(LIBIXION_VERSION "0.20.0")
diff --git a/src/backend/spreadsheet/StatisticsSpreadsheet.cpp b/src/backend/spreadsheet/StatisticsSpreadsheet.cpp
index 0d5ebb6f9e..63208f2532 100644
--- a/src/backend/spreadsheet/StatisticsSpreadsheet.cpp
+++ b/src/backend/spreadsheet/StatisticsSpreadsheet.cpp
@@ -27,8 +27,8 @@
 
 StatisticsSpreadsheet::StatisticsSpreadsheet(Spreadsheet* spreadsheet, bool loading, AspectType type)
 	: Spreadsheet(i18n("Column Statistics"), loading, type)
-	, m_spreadsheet(spreadsheet) {
-	m_metricValues = {
+	, m_spreadsheet(spreadsheet)
+	, m_metricValues{
 		StatisticsSpreadsheet::Metric::Count,
 		StatisticsSpreadsheet::Metric::Minimum,
 		StatisticsSpreadsheet::Metric::Maximum,
@@ -57,8 +57,7 @@ StatisticsSpreadsheet::StatisticsSpreadsheet(Spreadsheet* spreadsheet, bool load
 		StatisticsSpreadsheet::Metric::Skewness,
 		StatisticsSpreadsheet::Metric::Kurtosis,
 		StatisticsSpreadsheet::Metric::Entropy,
-	};
-	m_metricNames = {
+	}, m_metricNames{
 		i18n("Count"),
 		i18n("Minimum"),
 		i18n("Maximum"),
@@ -87,8 +86,7 @@ StatisticsSpreadsheet::StatisticsSpreadsheet(Spreadsheet* spreadsheet, bool load
 		i18n("Skewness"),
 		i18n("Kurtosis"),
 		i18n("Entropy"),
-	};
-
+	} {
 	auto* model = m_spreadsheet->model();
 	connect(model, &SpreadsheetModel::dataChanged, this, &StatisticsSpreadsheet::update);
 	connect(model, &SpreadsheetModel::rowsRemoved, this, &StatisticsSpreadsheet::update);
-- 
GitLab

